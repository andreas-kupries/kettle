
<html><head>
<title>kettle_dsl - Kettle Quick Brew System</title>
<style type="text/css"><!--
    HTML {
	background: 	#FFFFFF;
	color: 		black;
    }
    BODY {
	background: 	#FFFFFF;
	color:	 	black;
    }
    DIV.doctools {
	margin-left:	10%;
	margin-right:	10%;
    }
    DIV.doctools H1,DIV.doctools H2 {
	margin-left:	-5%;
    }
    H1, H2, H3, H4 {
	margin-top: 	1em;
	font-family:	sans-serif;
	font-size:	large;
	color:		#005A9C;
	background: 	transparent;
	text-align:		left;
    }
    H1.title {
	text-align: center;
    }
    UL,OL {
	margin-right: 0em;
	margin-top: 3pt;
	margin-bottom: 3pt;
    }
    UL LI {
	list-style: disc;
    }
    OL LI {
	list-style: decimal;
    }
    DT {
	padding-top: 	1ex;
    }
    UL.toc,UL.toc UL, UL.toc UL UL {
	font:		normal 12pt/14pt sans-serif;
	list-style:	none;
    }
    LI.section, LI.subsection {
	list-style: 	none;
	margin-left: 	0em;
	text-indent:	0em;
	padding: 	0em;
    }
    PRE {
	display: 	block;
	font-family:	monospace;
	white-space:	pre;
	margin:		0%;
	padding-top:	0.5ex;
	padding-bottom:	0.5ex;
	padding-left:	1ex;
	padding-right:	1ex;
	width:		100%;
    }
    PRE.example {
	color: 		black;
	background: 	#f5dcb3;
	border:		1px solid black;
    }
    UL.requirements LI, UL.syntax LI {
	list-style: 	none;
	margin-left: 	0em;
	text-indent:	0em;
	padding:	0em;
    }
    DIV.synopsis {
	color: 		black;
	background: 	#80ffff;
	border:		1px solid black;
	font-family:	serif;
	margin-top: 	1em;
	margin-bottom: 	1em;
    }
    UL.syntax {
	margin-top: 	1em;
	border-top:	1px solid black;
    }
    UL.requirements {
	margin-bottom: 	1em;
	border-bottom:	1px solid black;
    }
--></style>
</head>
<! -- Generated from file '/net/nas/data/andreask/Dev/Struct/kettle/embedded/www/doc/files/kettle_dsl.html' by tcllib/doctools with format 'html'
   -->
<! -- CVS: $Id$ kettle_dsl.n
   -->
<body><div class="doctools">
<hr> [
  <a href="../../toc.html">Main Table Of Contents</a>
| <a href="../toc.html">Table Of Contents</a>
| <a href="../../index.html">Keyword Index</a>
] <hr>
<h1 class="title">kettle_dsl(n) 0 doc &quot;Kettle Quick Brew System&quot;</h1>
<div id="name" class="section"><h2><a name="name">Name</a></h2>
<p>kettle_dsl - Kettle - Build Declarations</p>
</div>
<div id="toc" class="section"><h2><a name="toc">Table Of Contents</a></h2>
<ul class="toc">
<li class="section"><a href="#toc">Table Of Contents</a></li>
<li class="section"><a href="#synopsis">Synopsis</a></li>
<li class="section"><a href="#section1">Description</a></li>
<li class="section"><a href="#section2">The kettle application</a></li>
<li class="section"><a href="#section3">Build declarations</a></li>
<li class="section"><a href="#section4">build.tcl Example</a></li>
<li class="section"><a href="#section5">License</a></li>
<li class="section"><a href="#section6">Bugs, Ideas, Feedback</a></li>
<li class="section"><a href="#keywords">Keywords</a></li>
<li class="section"><a href="#category">Category</a></li>
</ul>
</div>
<div id="synopsis" class="section"><h2><a name="synopsis">Synopsis</a></h2>
<div class="synopsis">
<ul class="requirements">
<li>package require <b class="pkgname">Tcl 8.5</b></li>
</ul>
<ul class="syntax">
<li><a href="#1"><b class="cmd">kettle doc</b> <span class="opt">?<i class="arg">docroot</i>?</span></a></li>
<li><a href="#2"><b class="cmd">kettle doc-destination</b> <i class="arg">path</i></a></li>
<li><a href="#3"><b class="cmd">kettle figures</b> <span class="opt">?<i class="arg">figroot</i>?</span></a></li>
</ul>
</div>
</div>
<div id="section1" class="section"><h2><a name="section1">Description</a></h2>
<p>Welcome to Kettle, a set of packages providing support for writing
build code for Tcl packages.</p>
<p>Please read the document <i class="term"><a href="kettle_intro.html">Kettle - Introduction to Kettle</a></i>,
if you have not done so already, to get an overview of the whole system.</p>
</div>
<div id="section2" class="section"><h2><a name="section2">The kettle application</a></h2>
</div>
<div id="section3" class="section"><h2><a name="section3">Build declarations</a></h2>
<dl class="definitions">
    
<dt><a name="1"><b class="cmd">kettle doc</b> <span class="opt">?<i class="arg">docroot</i>?</span></a></dt>
<dd><p>This command declares the presence of <b class="package">doctools</b>-based
documentation files under the directory <i class="arg">docroot</i>, which is a
path relative to the source directory we are in.</p>
<p>If not specified <i class="arg">docroot</i> defaults to &quot;<b class="file">doc</b>&quot;.</p>
<p>If documentation files are found the command will define the
recipe &quot;doc&quot; which, when invoked, will convert the documentation into
HTML and nroff and save the result of that conversion into the
directory specified by <b class="cmd">kettle doc-destination</b> (see below) or
<b class="syscmd"><a href="kettle.html">kettle</a></b>'s option <b class="option">--doc-destination</b>. The default for
this is &quot;<b class="file">embedded</b>&quot;.</p>
<p>It will further define the recipes</p>
<ol class="enumerated">
<li><p>&quot;install-doc-manpages&quot;</p></li>
<li><p>&quot;install-doc-html&quot;</p></li>
<li><p>&quot;drop-doc-manpages&quot;</p></li>
<li><p>&quot;drop-doc-html&quot;</p></li>
</ol>
<p>and extend the recipes &quot;install-doc&quot;, &quot;install&quot;, &quot;drop-doc&quot;, and
&quot;drop&quot;.  This enables the package builder to (un)install the
documentation, all, or in part.</p>
<p>The documentation in these recipes is taken from the doc
destination directory in the package sources (see recipe &quot;doc&quot; above).</p>
<p>Now for various important notes, limitations, etc.:</p>
<ol class="enumerated">
<li><p>This command is run for effect only once, even if invoked
	multiple times. First invocation wins.</p></li>
<li><p>This command is run implicitly by <b class="cmd">kettle tcl</b>.</p></li>
<li><p>The previous two items together mean that any non-standard
	settings, be it documentation root or destination must come
	before <b class="cmd">kettle tcl</b>, if that command is used.</p></li>
<li><p>Documentation files are recognized by containing any of the
	markers</p>
<ul class="itemized">
	
<li><p>&quot;<b class="const">[manpage_begin</b>&quot;</p></li>
<li><p>&quot;<b class="const">--- doctools ---</b>&quot;</p></li>
<li><p>&quot;<b class="const">tcl.tk//DSL doctools//EN//</b>&quot;</p></li>
</ul>
<p>in their first 1024 characters. Possible documentation files
	containing the <b class="const">[manpage_begin</b> marker are rejected
	should they contain any of the anti-markers</p>
<ul class="itemized">
	
<li><p>&quot;<b class="const">--- !doctools ---</b>&quot;</p></li>
<li><p>&quot;<b class="const">!tcl.tk//DSL doctools//EN//</b>&quot;</p></li>
</ul>
<p>in their first 1024 characters. This last is necessary as
	doctools include file feature allows the actual document
	content to start in an include file which cannot operate
	without being includes from a master file configuring it.</p></li>
<li><p>The &quot;doc&quot; recipe uses the <b class="syscmd">dtplite</b> application to
	perform the various conversions. It will fail if this
	application cannot be found on the <b class="variable">PATH</b>.</p></li>
<li><p>This command calls &quot;<b class="cmd">kettle figures</b> <i class="arg">docroot</i>/figures&quot;
	to search for and handle diagrams. Any non-standard settings
	for diagrams must be declared before <b class="cmd">kettle doc</b> itself
	is used.</p></li>
</ol></dd>
<dt><a name="2"><b class="cmd">kettle doc-destination</b> <i class="arg">path</i></a></dt>
<dd><p>The &quot;doc&quot; recipe generated by the <b class="cmd">kettle doc</b> command above
saves its conversion results by default in the sub-directory
&quot;<b class="file">embedded</b>&quot; of the package/application source directory.</p>
<p>This command is for the general adjustment of this default
	destination for the package/application.</p>
<p>It can also be adjusted on a per-run basis through the option
	<b class="option">--doc-destination</b> of <b class="cmd"><a href="kettle.html">kettle</a></b></p></dd>
<dt><a name="3"><b class="cmd">kettle figures</b> <span class="opt">?<i class="arg">figroot</i>?</span></a></dt>
<dd><p>This command declares the presence of <b class="package">diagram</b>-based figures
under the directory <i class="arg">figroot</i>, which is a path relative to the
source directory we are in.</p>
<p>If not specified <i class="arg">figroot</i> defaults to &quot;<b class="file">doc/figures</b>&quot;.</p>
<p>If figures are found the command will define two recipes,
&quot;figures&quot; and &quot;show-figures&quot;. When invoked the first will convert the
figures into raster images in PNG format and save them as siblings to
their source files. The second will launch a <b class="package">Tk</b>-based GUI
rendering the figures to a canvas.</p>
<p>Now for various important notes, limitations, etc.:</p>
<ol class="enumerated">
<li><p>This command is run for effect only once, even if invoked
	multiple times. First invocation wins.</p></li>
<li><p>This command is run implicitly by <b class="cmd">kettle doc</b>, using
	its <i class="arg">docroot</i> as basis for <i class="arg">figroot</i>, i.e.
	&quot;<b class="file"><i class="arg">docroot</i>/figures</b>&quot;.</p></li>
<li><p>The previous two items together mean that any non-standard
	settings for the figure root must come before
	<b class="cmd">kettle doc</b>, if that command is used, directly, or
	indirectly (like through <b class="cmd">kettle tcl</b>, for example).</p></li>
<li><p>Diagram files are recognized by containing the marker</p>
<ul class="itemized">
	
<li><p>&quot;<b class="const">tcl.tk//DSL diagram//EN//</b>&quot;</p></li>
</ul>
<p>in their first 1024 characters.</p></li>
<li><p>The two recipes use the tklib <b class="syscmd">dia</b> application to
	perform the conversion and GUI display. They will fail if
	this application cannot be found on the <b class="variable">PATH</b>.</p></li>
</ol></dd>
</dl>
</div>
<div id="section4" class="section"><h2><a name="section4">build.tcl Example</a></h2>
<p>A simple example of a build.tcl script is that for kettle itself.</p>
<p>Stripping out the special code taking core of the fact that it
cannot assume to be installed already this reduces to the code below,
and of that only the last two lines are relevant in terms of build
declarations. The first three are the magic to find and run the kettle
application in the <b class="variable">PATH</b>
(The actual code assumes that <b class="cmd"><a href="kettle.html">kettle</a></b> is found the working
directory, again it cannot assume to be installed already).</p>
<pre class="example">
#!/bin/sh
# -*- tcl -*- \
exec kettle -f &quot;$0&quot; &quot;${1+$@}&quot;
kettle tcl
kettle tclapp kettle
</pre>
<p>We ask it to search for and handle all Tcl script packages to
be found in the directory of the &quot;<b class="file">build.tcl</b>&quot; file, and that we
have one script application in that same directory.
As the documentation files and figures are in the standard locations,
we let <b class="cmd">kettle tcl</b> handle them implicitly.</p>
<p>Done.</p>
</div>
<div id="section5" class="section"><h2><a name="section5">License</a></h2>
<p>This package, written by Andreas Kupries, is BSD licensed.</p>
</div>
<div id="section6" class="section"><h2><a name="section6">Bugs, Ideas, Feedback</a></h2>
<p>This document, and the package it describes, will undoubtedly contain
bugs and other problems.
Please report such at the
<a href="https://chiselapp.com/user/andreas_kupries/repository/Kettle/index">Kettle Tracker</a>.
Please also report any ideas for enhancements you may have for either
package and/or documentation.</p>
</div>
<div id="keywords" class="section"><h2><a name="keywords">Keywords</a></h2>
<p><a href="../../index.html#key0">build tea</a></p>
</div>
<div id="category" class="section"><h2><a name="category">Category</a></h2>
<p>Build support</p>
</div>
</div></body></html>
